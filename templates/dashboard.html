{% extends "base.html" %}

{% block extra_js %}
<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="https://maps.googleapis.com/maps/api/js"></script>
<script type="text/javascript" src="/static/js/markerclusterer.js"></script>
<script type="text/javascript" src="/static/js/infobox.js"></script>
<script type="text/javascript">
    var map;
    var markers = [];
    $(document).ready(function () {
        var infowindow = new google.maps.InfoWindow();
        var myLatlng = new google.maps.LatLng({{latitud}}, {{longitud}});
        var myOptions = {
            zoom: 10,
            mapTypeControl: true,
            scaleControl: false,
            scrollwheel: false,
            center: myLatlng,
            mapTypeId: google.maps.MapTypeId.ROADMAP
        }
        map = new google.maps.Map(document.getElementById("map-canvas"), myOptions);


        $.getJSON("{% url 'obtener-lista' %}", function(data){
            $.each(data, function(i, elemento){
                var latlng = new google.maps.LatLng(elemento.lat, elemento.lon);
                var marker = new google.maps.Marker({
                    position: latlng,
                    map: map,
                    title: elemento.nombre,
                    item: '',
                    id: elemento.id
                });
                markers.push(marker);
            });
            var markerCluster = new MarkerClusterer(map, markers);
        });

    });

</script>
// estos son los graficos de clima y indicadores
<script>
    $(function () {
    $('#grafico5').highcharts({
        chart: {
            zoomType: 'xy'
        },
        title: {
            text: 'Average Monthly Temperature and Rainfall in Tokyo'
        },
        subtitle: {
            text: 'Source: WorldClimate.com'
        },
        xAxis: [{
            categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',
                'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'],
            crosshair: true
        }],
        yAxis: [{ // Primary yAxis
            labels: {
                format: '{value}°C',
                style: {
                    color: Highcharts.getOptions().colors[1]
                }
            },
            title: {
                text: 'Temperature',
                style: {
                    color: Highcharts.getOptions().colors[1]
                }
            }
        }, { // Secondary yAxis
            title: {
                text: 'Rainfall',
                style: {
                    color: Highcharts.getOptions().colors[0]
                }
            },
            labels: {
                format: '{value} mm',
                style: {
                    color: Highcharts.getOptions().colors[0]
                }
            },
            opposite: true
        }],
        tooltip: {
            shared: true
        },
        legend: {
            layout: 'vertical',
            align: 'left',
            x: 120,
            verticalAlign: 'top',
            y: 100,
            floating: true,
            backgroundColor: (Highcharts.theme && Highcharts.theme.legendBackgroundColor) || '#FFFFFF'
        },
        series: [{
            name: 'Rainfall',
            type: 'column',
            yAxis: 1,
            data: [49.9, 71.5, 106.4, 129.2, 144.0, 176.0, 135.6, 148.5, 216.4, 194.1, 95.6, 54.4],
            tooltip: {
                valueSuffix: ' mm'
            }

        }, {
            name: 'Temperature',
            type: 'spline',
            data: [7.0, 6.9, 9.5, 14.5, 18.2, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6],
            tooltip: {
                valueSuffix: '°C'
            }
        }]
    });
});

/*******graficos de prueba***********/
$(function () {

    $(document).ready(function () {

        // Build the chart
        $('#grafico1').highcharts({
            chart: {
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false,
                type: 'pie'
            },
            title: {
                text: 'PATRÓN DE GASTOS'
            },
            tooltip: {
                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    dataLabels: {
                        enabled: false
                    },
                    showInLegend: true
                }
            },
            series: [{
                name: "Brands",
                colorByPoint: true,
                data: [{
                    name: "gastos de la finca",
                    y: {{gasto_finca}}
                }, {
                    name: "Gastos fuera de la finca",
                    y: {{gasto_fuera_finca}},
                    sliced: true,
                    selected: true
                }]
            }]
        });
    });
});
$(function () {
    $('#grafico2').highcharts({
        chart: {
            type: 'column'
        },
        title: {
            text: 'Monthly Average Rainfall'
        },
        xAxis: {
            categories: [
                'Jan',
                'Feb',
                'Mar',
                'Apr',
                'May'
            ],
            crosshair: true
        },
        yAxis: {
            min: 0,
            title: {
                text: 'Rainfall (mm)'
            }
        },
        tooltip: {
            headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
            pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                '<td style="padding:0"><b>{point.y:.1f} mm</b></td></tr>',
            footerFormat: '</table>',
            shared: true,
            useHTML: true
        },
        plotOptions: {
            column: {
                pointPadding: 0.2,
                borderWidth: 0
            }
        },
        series: [{
            name: 'Tokyo',
            data: [49.9, 71.5, 106.4, 129.2, 144.0]

        }, {
            name: 'London',
            data: [48.9, 38.8, 39.3, 41.4, 47.0]

        }, {
            name: 'Berlin',
            data: [42.4, 33.2, 34.5, 39.7, 52.6]

        }]
    });
});

$(function () {
    $('#grafico3').highcharts({
        chart: {
            type: 'column'
        },
        title: {
            text: 'Monthly Average Rainfall'
        },
        xAxis: {
            categories: [
                'Jan',
                'Feb',
                'Mar',
                'Apr',
                'May'
            ],
            crosshair: true
        },
        yAxis: {
            min: 0,
            title: {
                text: 'Rainfall (mm)'
            }
        },
        tooltip: {
            headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
            pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                '<td style="padding:0"><b>{point.y:.1f} mm</b></td></tr>',
            footerFormat: '</table>',
            shared: true,
            useHTML: true
        },
        plotOptions: {
            column: {
                pointPadding: 0.2,
                borderWidth: 0
            }
        },
        series: [{
            name: 'Tokyo',
            data: [49.9, 71.5, 106.4, 129.2, 144.0]

        }, {
            name: 'London',
            data: [48.9, 38.8, 39.3, 41.4, 47.0]

        }, {
            name: 'Berlin',
            data: [42.4, 33.2, 34.5, 39.7, 52.6]

        }]
    });
});

$(function () {
    $('#grafico4').highcharts({
        chart: {
            type: 'column'
        },
        title: {
            text: 'Monthly Average Rainfall'
        },

        xAxis: {
            categories: [
                'Jan',
                'Feb',
                'Mar',
                'Apr',
                'May'
            ],
            crosshair: true
        },
        yAxis: {
            min: 0,
            title: {
                text: 'Rainfall (mm)'
            }
        },
        tooltip: {
            headerFormat: '<span style="font-size:10px">{point.key}</span><table>',
            pointFormat: '<tr><td style="color:{series.color};padding:0">{series.name}: </td>' +
                '<td style="padding:0"><b>{point.y:.1f} mm</b></td></tr>',
            footerFormat: '</table>',
            shared: true,
            useHTML: true
        },
        plotOptions: {
            column: {
                pointPadding: 0.2,
                borderWidth: 0
            }
        },
        series: [{
            name: 'Tokyo',
            data: [49.9, 71.5, 106.4, 129.2, 120.0]

        }, {
            name: 'London',
            data: [48.9, 38.8, 39.3, 41.4, 47.0]

        }, {
            name: 'Berlin',
            data: [42.4, 33.2, 34.5, 39.7, 52.6]

        }]
    });
});
</script>
{% endblock extra_js %}

{% block contenido %}
 <style>
      #map-canvas {
        width: 100%;
        height: 450px;
        margin: 0 auto;
        background-color: #CCC;
      }
    </style>


<div class="row filtros">
    <ol class="breadcrumb">
        <li>SELECCIÓN DE PAÍS</li>
        <li>SELECCIÓN DE DEPARTAMENTO</li>
        <li>INDICADORES POR DEPARTAMENTO</li>

    </ol>
</div>


<div class="contenido-general">
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 mapa-general">
        {# mapa #}
            <div id="map-canvas"></div>

            <a class='btn btn-tgeneral center-block' href="/indicadores/">TABLERO DE INDICADORES</a>
        </div>
        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 graficos-general">
            <div class="row">
                <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6" id="grafico1" style="height: 270px;"></div>
                <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6" id="grafico2" style="height: 270px;"></div>
            </div>
            <div class="row">
                <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6" id="grafico3" style="height: 270px;"></div>
                <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6" id="grafico4" style="height: 270px;"></div>
            </div>
        </div>
    </div>


    <div class="row fila2">
        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 table-responsive tabla-productor">
            <table class="table table-hover">
            {% for obj in ahora %}
                <thead>
                    <tr>
                        <th>NOMBRE DE FINCA</th>
                        <th>SEXO</th>
                        <th>DETALLE</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>{{obj.entrevistado.finca}}</td>
                        <td class="sexo">
                        {% if obj.entrevistado.sexo == '2' %}
                            <span class="fa fa-female"> Femenino</span>

                          {% else %}
                            <span class="fa fa-male"> Masculino</span>
                        {% endif %}


                         </td>
                        <td>
                            <a class='btn center-block btn-tabla' href="{% url 'detalle-finca' obj.entrevistado.id %}">Detalle</a>
                        </td>
                    </tr>
                </tbody>
             {% endfor %}
            </table>

        </div>

        <div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 grafico-clima" id="grafico5">

        </div>
    </div>
</div>

<!--

	<div class="row">

    <br>

	</div>
	{# indicadores #}
	<div class="row">
		<h1>indicadores</h1>
	</div>
	{# fichas familia #}
	<div class="row">
		<h1>Miembros familiares</h1>
    {% for obj in ahora %}
      <ul>
        <li>{{obj.entrevistado}} || {{obj.entrevistado.finca}} | <a class='btn' href="{% url 'detalle-finca' obj.entrevistado.id %}">Detalle</a></li>
      </ul>
    {% endfor %}
	</div>
	{# clima #}
	<div class="row">
		<h1>Clima</h1>

	</div>-->
{% endblock contenido %}
