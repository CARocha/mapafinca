{% extends "base.html" %}
{% load humanize %}
{% load thumbnail %}
{% block extra_js %}
<script src="http://code.highcharts.com/highcharts.js"></script>
<script src="http://code.highcharts.com/modules/exporting.js"></script>

<script src="https://maps.googleapis.com/maps/api/js?v=3.exp&signed_in=true"></script>
<script type="text/javascript" src="/static/js/markerclusterer.js"></script>
<script type="text/javascript" src="/static/js/infobox.js"></script>
<script type="text/javascript">

    function initialize() {
  			var myLatlng = new google.maps.LatLng({{latitud}},{{longitud}});
  			var mapOptions = {
    		zoom: 12,
    		center: myLatlng
  		}
  		var map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);

  		var marker = new google.maps.Marker({
		      position: myLatlng,
		      map: map,
		      title: ''
  			});
	}

	google.maps.event.addDomListener(window, 'load', initialize);


</script>

<script>
	$('#myTabs a').click(function (e) {
	  e.preventDefault()
	  $(this).tab('show')
	})
/****graficos de prueba dejar mismo id*****/
$(function () {
    // Create the chart
    {% for k,v in gran_dicc.items %}

    $('#ficha-grafico1-{{k}}').highcharts({
        chart: {
            type: 'column'
        },
        title: {
            text: 'Miembros que poseen educación {{k}}'
        },
        xAxis: {
            type: 'category'
        },
        yAxis: {
            title: {
                text: 'porcentaje'
            }
        },
        legend: {
            enabled: false
        },
        plotOptions: {
            series: {
                borderWidth: 0,
                dataLabels: {
                    enabled: true,
                    format: '{point.y:.1f}'
                }
            }
        },
        tooltip: {
            headerFormat: '<span style="font-size:11px">{series.name}</span><br>',
            pointFormat: '<span style="color:{point.color}">{point.name}</span>: <b>{point.y:.2f}</b><br/>'
        },
        series: [{
            name: "porcentaje",
            colorByPoint: true,
            data: [
            {% for value in v.0 %}
            {
                name: "{{value.0}}",
                y: {{value.1}},
            },
            {% endfor %}
            ]
        }],
    });

	//fin del grafico de educacion
	//
	//Inicio del grafico de ingreso
	$('#ficha-grafico2-{{k}}').highcharts({
            chart: {
                plotBackgroundColor: null,
                plotBorderWidth: null,
                plotShadow: false,
                type: 'pie'
            },
            title: {
                text: 'Ingreso vs gastos ({{k}})'
            },
            tooltip: {
                pointFormat: '{series.name}: <b>{point.percentage:.1f}%</b>'
            },
            plotOptions: {
                pie: {
                    allowPointSelect: true,
                    cursor: 'pointer',
                    dataLabels: {
                        enabled: false
                    },
                    showInLegend: true
                }
            },
            series: [{
                name: "C$",
                colorByPoint: true,
                data: [{
                    name: "Ingreso",
                    y: 56.33
                }, {
                    name: "Gasto",
                    y: 24.03,
                    sliced: true,
                    selected: true
                }]
            }]
        });


	{% endfor %}
}); //fin funcion anonima

$(function () {

    $(document).ready(function () {

        // Build the chart

    });
});

$(function () {
    $('#ficha-grafico3').highcharts({
        chart: {
            type: 'line'
        },

        xAxis: {
            categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
        },
        yAxis: {
            title: {
                text: 'Temperature (°C)'
            }
        },
        plotOptions: {
            line: {
                dataLabels: {
                    enabled: true
                },
                enableMouseTracking: false
            }
        },
        series: [{
            name: 'Tokyo',
            data: [7.0, 6.9, 9.5, 14.5, 18.4, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6]
        }, {
            name: 'London',
            data: [3.9, 4.2, 5.7, 8.5, 11.9, 15.2, 17.0, 16.6, 14.2, 10.3, 6.6, 4.8]
        }]
    });
});


$(function () {
    $('#ficha-grafico4').highcharts({
        chart: {
            type: 'line'
        },

        xAxis: {
            categories: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun', 'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec']
        },
        yAxis: {
            title: {
                text: 'Temperature (°C)'
            }
        },
        plotOptions: {
            line: {
                dataLabels: {
                    enabled: true
                },
                enableMouseTracking: false
            }
        },
        series: [{
            name: 'Tokyo',
            data: [7.0, 6.9, 9.5, 14.5, 18.4, 21.5, 25.2, 26.5, 23.3, 18.3, 13.9, 9.6]
        }, {
            name: 'London',
            data: [3.9, 4.2, 5.7, 8.5, 11.9, 15.2, 17.0, 16.6, 14.2, 10.3, 6.6, 4.8]
        }]
    });
});

</script>
{% endblock extra_js %}

{% block contenido %}
 <style>
 #map-canvas {
 	width: 100%;
    height: 608px;
    margin: 0;
    padding: 0;
    background-color: #CCC;
}
</style>
<div class="row filtros">
    <ol class="breadcrumb">
        <li>SELECCIÓN DE PAÍS</li>
        <li>SELECCIÓN DE DEPARTAMENTO</li>
        <li>INDICADORES POR DEPARTAMENTO</li>
        <li>DETALLE DE FINCA</li>

    </ol>
</div>
<!--informacion privada del productor y la finca >> inicio-->
	<div class="row info-admin">
	{% for obj in detalle|slice:":1" %}
		<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 mapa-finca alinear">
			<div id="map-canvas"></div>
		</div>
		<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 finca-datos alinear">
			<div class="titulo-info">
				FICHA TECNICA
			</div>
			<div class="row ficha-contenido">

				<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
					<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
						<h5>Años entrevistados</h5>
						<p class="dato-productor">
                        {% for obj in detalle %}
							{{obj.year}}{% if not forloop.last %},{% endif %}
                        {% endfor %}
						</p>
					</div>
				</div>
				<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
					<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
						<h5>Nombre del Encuestador</h5>
						<p class="dato-productor">
							{{obj.encuestador}}
						</p>
					</div>
					<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6">
						<h5>Nombre Organización Responsable</h5>
						<p class="dato-productor">
							{{obj.org_responsable}}
						</p>
					</div>
				</div>


			</div>

		</div>
		<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 finca-datos alinear">
			<div class="titulo-info">
				INFORMACIÓN DEL ENTREVISTADO
			</div>
			<div class="row ficha-contenido">

				<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
					<div class="col-xs-12 col-sm-12 col-md-8 col-lg-8">
						<h5>Nombre del Productor</h5>
						<p class="dato-productor">
							{{obj.entrevistado}}
						</p>
					</div>
					<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
						<h5>Sexo</h5>
						<p class="dato-productor">
							{{obj.entrevistado.get_sexo_display}}
						</p>
					</div>
				</div>
				<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
					<div class="col-xs-12 col-sm-12 col-md-8 col-lg-8">
						<h5>Número de Cedula</h5>
						<p class="dato-productor">
							{{obj.entrevistado.cedula}}
						</p>
					</div>
					<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
						<h5>Jefe de Hogar</h5>
						<p class="dato-productor">
							{{obj.entrevistado.get_jefe_display}}
						</p>
					</div>
				</div>
				<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
					<div class="col-xs-12 col-sm-12 col-md-8 col-lg-8">
						<h5>Ocupación</h5>
						<p class="dato-productor">
							{{obj.entrevistado.ocupacion}}
						</p>
					</div>
					<div class="col-xs-12 col-sm-12 col-md-4 col-lg-4">
						<h5>Edad</h5>
						<p class="dato-productor">
							{{obj.entrevistado.edad}} Años
						</p>
					</div>
				</div>


			</div>

		</div>
		<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 finca-datos alinearfull">
			<div class="titulo-info">
				INFORMACIÓN DE LA FINCA
			</div>
			<div class="row ficha-contenido">

				<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
					<div class="col-xs-12 col-sm-6 col-md-3 col-lg-3">
						<h5>Departamento</h5>
						<p class="dato-productor">
							{{obj.entrevistado.departamento}}
						</p>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3 col-lg-3">
						<h5>Municipio</h5>
						<p class="dato-productor">
							{{obj.entrevistado.municipio}}
						</p>
					</div>
					<div class="col-xs-12 col-sm-6 col-md-3 col-lg-3">
						<h5>Comunidad</h5>
						<p class="dato-productor">
                         {% if  obj.entrevistado.comunidad %}
                             {{obj.entrevistado.comunidad}}
                         {% else %}
                             Este dato no fue recolectado
                         {% endif %}

						</p>
					</div>

					<div class="col-xs-12 col-sm-6 col-md-3 col-lg-3">
						<h5>Microcuenca</h5>
						<p class="dato-productor">
                        {% if  obj.entrevistado.microcuenca %}
                             {{obj.entrevistado.microcuenca}}
                         {% else %}
                             Este dato no fue recolectado
                         {% endif %}

						</p>
					</div>
				</div>


				<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
					<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
						<h5>Nombre de la finca</h5>
						<p class="dato-productor">
							{{obj.entrevistado.finca}}
						</p>
					</div>
				</div>



			</div>

		</div>
	{% endfor %}
	</div>
<!--informacion privada del productor y la finca >> final-->
<div class="contenido-detallefinca">
	<div class="row list-anos">
		<div class="col-xs-12 col-sm-12 col-md-2 col-lg-2 titulo-anos">
			<h5>SELECCIONAR AÑO:</h5>
		</div>
		<div class="col-xs-12 col-sm-12 col-md-10 col-lg-10 botones-anos">
			<ul class="nav nav-tabs row" role="detalle">
			  {% for obj in detalle %}
			 	<li class="col-xs-6 col-sm-6 col-md-2 col-lg-2  {% if forloop.counter == 1 %}active{% endif %} " role="presentation">
			 		<a class="btn btn-anos" href="#home{{forloop.counter}}" aria-controls="home{{forloop.counter}}" role="tab" data-toggle="tab">{{obj.year}}</a>
			 	</li>
			  {% endfor %}

			</ul>

		</div>
	</div>
	<div class="row info-publica">
		<div class="tab-content">
		  {% for obj in detalle %}
			<div role="tabpanel" class="tab-pane {% if forloop.counter == 1 %}active {%else %} fade{% endif %}" id="home{{forloop.counter}}">
				<div class="row ficha-fila1">
					<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 img-mapafinca alinear">
						<div class="titulo-info">
								MAPA DE FINCA AÑO {{obj.year}}
						</div>
						<a data-toggle="modal" href='#modal-id-{{obj.year}}'>
                        {% if obj.mapa_finca %}
                            {% thumbnail obj.mapa_finca "800x500" as im %}
                                <img src="/media/{{im}}" alt="">
                            {% endthumbnail %}
                        {% else %}
                            <img src="http://placehold.it/800x500">
                        {% endif %}
						</a>

					</div>
					<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 ficha-grafico alinear" >
						<div class="titulo-info">
								MIEMBROS DEL HOGAR QUE ALCANZARON (Pri.,Secun.,Br,Univ.)
						</div>
						<div id="ficha-grafico1-{{obj.year}}" style="height:370px;"></div>
					</div>
				</div>

				<div class="row ficha-fila2">
					<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 ficha-grafico alinear">
						<div class="titulo-info">
								INGRESO VS GASTO
						</div>
						<div id="ficha-grafico2-{{obj.year}}" style="height:466px;"></div>
					</div>

					<div class="col-xs-12 col-sm-12 col-md-6 col-lg-6 alinear">
						<div class="row">
							<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 ficha-grafico espacio">
								<div class="titulo-info">
										TOTAL DE INGRESOS
								</div>
								<div id="ficha-grafico3" style="height:200px;"></div>
							</div>
							<div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 ficha-grafico">
								<div class="titulo-info">
										TOTAL GASTOS DEL HOGAR
								</div>
								<div id="ficha-grafico4" style="height:200px;"></div>
							</div>

						</div>
					</div>
				</div>

			  	total:{{obj.totalingreso.total|intcomma}} <br>
			  	total gasto: {{obj.totalingreso.total_gasto|intcomma}} <br>
			  	total gasto fuera de la finca: {{obj.totalingreso.total_gasto_fuera_finca|intcomma}} <br>

			  	<div class="modal fade" id="modal-id-{{obj.year}}">
			  		<div class="modal-dialog modal-lg">
			  			<div class="modal-content">
			  				<div class="modal-header">
			  					<button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
			  					<h4 class="modal-title titulo-modal">Nombre de la finca</h4>
			  				</div>
			  				<div class="modal-body">
			  					<img src="/media/{{obj.mapa_finca}}">
			  				</div>
			  				<div class="modal-footer">
			  					<button type="button" class="btn btn-default" data-dismiss="modal">Cerrar</button>

			  				</div>
			  			</div>
			  		</div>
			  	</div>
		  	</div>
		  	 {% endfor %}
		</div>

	</div>
</div>


{% endblock contenido %}

